<!DOCTYPE html>
<html>

<head>
  <title>
    my calculator
  </title>
  <style type="text/css">

    .calculator {
      background-image: url('a/wood-texture.jpg');
      width: 677px;
      height: 380px;
      border: 7px solid #C47F4F;
      background-color: white;
    }

    .funct {
      margin-left: 0.1px;
      width: 677px;
      height: 170px;
    }

    .display {
      width: 422px;
      height: 208px;
      border-bottom: 1.5px solid black;
      border-left: 1.5px solid black;
      float: left;
    }

    .number {
      margin-left: 0.1px;
      margin-top: -1px;
      width: 253px;
      height: 208px;
      float: left;
    }

    #result {
      width: 422px;
      height: 45px;
      font: bold 20px sans-serif;
    }

    #code {
      width: 422px;
      height: 120px;
      font: bold 20px sans-serif;
      border-bottom: 2px dotted black;
    }

    .prev {
      float: left;
      display: inline-block;
      width: 101px;
      height: 37px;
      border: 1.5px solid black;
      margin-bottom: 2px;
      margin-right: 2px;
      text-align: center;
      font: bold 21px sans-serif;
      float: right;
      box-shadow:
      inset 0 6px 6px rgba(255, 255, 255, 0.3),
      inset 0 -6px 6px rgba(0, 0, 0, 0.3),
      0 0px 0px rgba(255, 255, 255, 0.9);
    }

    .key {
      display: inline-block;
      float: left;
      width: 60px;
      height: 39px;
      border: 1.5px solid black;
      text-align: center;
      font: bold 20px sans-serif;
      box-shadow:
      inset 0 6px 6px rgba(255, 255, 255, 0.3),
      inset 0 -6px 6px rgba(0, 0, 0, 0.3),
      0 0px 0px rgba(255, 255, 255, 0.9);
    }

    #key_f {
      float: left;
      display: inline-block;
      width: 81.5px;
      height: 40px;
      border: 1.5px solid black;
      text-align: center;
      font: bold 20px sans-serif;
      box-shadow:
      inset 0 6px 6px rgba(255, 255, 255, 0.3),
      inset 0 -6px 6px rgba(0, 0, 0, 0.3),
      0 0px 0px rgba(255, 255, 255, 0.9);
    }

    .selected {
      box-shadow:
      inset 0 6px 6px rgba(0, 0, 0, 0.3),
      inset 0 -6px 6px rgba(255, 255, 255, 0.3),
      0 0px 0px rgba(255, 255, 255, 0.9);
      cursor: pointer;
      border: 1.5px solid black;
      font-size: 22px;
    }

    #key_f:hover{
      content: none;
      cursor: pointer;
      border: 1.5px solid black;
      font-size: 22px;
      position: relative;
      box-shadow:
      inset 0 6px 6px rgba(0, 0, 0, 0.3),
      inset 0 -6px 6px rgba(255, 255, 255, 0.3),
      0 0px 0px rgba(255, 255, 255, 0.9);
    }

    #key_f[mypop]:hover:after {
      content: attr(mypop);
      border: 1px solid black;
      background-color: #CB9262;
      position: absolute;
      font-size: 18px;
      z-index: 9999;
      width: 250px;
      padding: 8px 12px;
      color: black;
      left: 0;
      top: 50%;
      white-space: pre-line;
      border-radius: 13px; //둥글게
    }

    .prev[mypop]:hover:after {
      content: attr(mypop);
      border: 1px solid black;
      background-color: #CB9262;
      position: absolute;
      font-size: 18px;
      z-index: 9999;
      width: 230px;
      padding: 8px 12px;
      color: black;
      left: 17px;
      top: 53%;
      white-space: pre-line;
      border-radius: 13px; //둥글게
    }
  </style>

  <script src="a/jquery-3.3.1.js" type="text/javascript"></script>
  <script src="a/math.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function() { //시작되었다

      $('#key_f, .prev, .key').hover(function() {
        $(this).addClass('selected');
      }, function() {
        $(this).removeClass('selected');
      }); //키위에 마우스 올라가면 이벤트

      var parser = math.parser();
      var displayValue = '0';
      var d_array = new Array();//누른것들 저장
      var list = new Array();//이전기록 저장
      d_array[0] = 0;
      list[0] = 0;
      var l = 0;//기록 저장한 개수
      var ll = 0;
      var n = 0;//버튼누른 개수
      $('#result').text(displayValue); //일단 처음값 출력

      $('.key, #key_f, .prev').each(function(index, key) { //키들
        $(this).click(function(e) {
          if (displayValue == '0') displayValue = '';
          $('#result').text(""); //다음 계산하면 전 결과 사라짐

          if ($(this).text() == '=') //계산버튼 누르면
          {
            n = 0;//다시0됨
            l++;//저장
            ll = l - 1;
            list[l] = displayValue;
            list[l] += ' = ';
            try {
              displayValue = parser.eval(displayValue).toString();
              var tokens = displayValue.split(' ');
              if (tokens[0] == 'function') {
                displayValue = tokens[0];
              }
              list[l] += displayValue;
              $('#result').text(displayValue);
              displayValue = '0';
            } catch (e) { //오류났을때
              displayValue = '0';
              if (displayValue != 'function') {
                $('#result').text(e);
              }
            }
          } else {
            switch ($(this).text()) {
              case '이전기록':
                if (ll == 0) {
                  $('#code').text('이전기록이 없습니다');
                } else {
                  $('#code').text('list[' + ll + '] : ' + list[ll]);
                  ll--;
                }
                break;
              case 'AC':
                n = 0;
                ll = l;
                displayValue = '0';
                $('#result').text(displayValue); //다시 0으로
                $('#code').text(""); //식 지움
                break;
              case '←':
                displayValue = ''; //일단 얘 초기화
                for (var i = 1; i < n; i++) {
                  displayValue += d_array[i]; //<-누르기전에 누른거까지만
                }
                $('#code').text(displayValue);
                n--; //줄여줘야 이어지지
                break;
              case 'in':
                n++; //누른개수
                d_array[n] = '='; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case '＜':
                n++; //누른개수
                d_array[n] = '<'; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case '＞':
                n++; //누른개수
                d_array[n] = '>'; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case '≤':
                n++; //누른개수
                d_array[n] = '<='; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case '≥':
                n++; //누른개수
                d_array[n] = '>='; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case 'e^x':
                n++; //누른개수
                d_array[n] = 'e^'; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case 'x^y':
                n++; //누른개수
                d_array[n] = '^'; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              case 'trans':
                n++; //누른개수
                d_array[n] = 'transpose'; //이거로 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
              default:
                n++; //누른개수
                d_array[n] = $(this).text(); //방금누른게 배열d에 저장
                displayValue += d_array[n]; //이어붙인다
                $('#code').text(displayValue); //식 입력
                break;
            }
          }
        });
      });
    });
  </script>

</head>

<body>

  <div class="calculator">
    <div class="funct">
      <span id="key_f" mypop="sin함수입니다
      sin ( 3 )">sin</span>
      <span id="key_f" mypop="cos함수입니다
      cos ( 3 )">cos</span>
      <span id="key_f" mypop="tan함수입니다
      tan ( 3 )">tan</span>
      <span id="key_f" mypop="e의 제곱입니다
      e^x 3 ≫ e^3">e^x</span>
      <span id="key_f" mypop="x의 y제곱입니다
      3 x^y 5 ≫ 3^5">x^y</span>
      <span id="key_f" mypop="제곱근입니다
      sqrt ( 3 )">sqrt</span>
      <span id="key_f" mypop="세제곱근입니다
      cbrt ( 3 )">cbrt</span>
      <span id="key_f" mypop="log함수입니다
      log ( 3 )">log</span>
      <span id="key_f">==</span>
      <span id="key_f">!=</span>
      <span id="key_f">＜</span>
      <span id="key_f">＞</span>
      <span id="key_f">≤</span>
      <span id="key_f">≥</span>
      <span id="key_f" mypop="벡터 내적입니다
      dot ( ( 1 , 2 ) , ( 3 , 4 ) )">dot</span>
      <span id="key_f" mypop="벡터 외적입니다
      cross( [ 1 , 2 ] [ 3 , 4 ] )">cross</span>
      <span id="key_f" mypop="변수 x입니다
      x in 3 ≫ x=3">x</span>
      <span id="key_f" mypop="변수 y입니다
      y in 3 ≫ y=3">y</span>
      <span id="key_f" mypop="변수 z입니다
      z in 3 ≫ z=3">z</span>
      <span id="key_f" mypop="함수 f입니다
      f ( x ) = x + 3">f</span>
      <span id="key_f" mypop="함수 g입니다
      g ( x ) = x + 3">g</span>
      <span id="key_f">in</span>
      <span id="key_f" mypop="역행렬입니다
      trans ( [ [ 1 , 2 ] , [ 3 , 4 ] ] )">trans</span>
      <span id="key_f" mypop="행렬의 determinent입니다
      det ( [ 1 , 2 ; 3 , 4 ] )">det</span>
      <span id="key_f" mypop="초기화합니다">AC</span>
      <span id="key_f" mypop="한글자씩 지웁니다">←</span>
      <span id="key_f">(</span>
      <span id="key_f">)</span>
      <span id="key_f">[</span>
      <span id="key_f">]</span>
      <span id="key_f">,</span>
      <span id="key_f">;</span>
    </div>
    <div class="display">
      <div id="code"></div>
      <div id="result"></div>
      <span class="prev" mypop="이전 기록을 보여줍니다">이전기록</span>
    </div>
    <div class="number">
      <span class="key">pi</span>
      <span class="key">e</span>
      <span class="key">i</span>
      <span class="key">%</span>
      <span class="key">7</span>
      <span class="key">8</span>
      <span class="key">9</span>
      <span class="key">/</span>
      <span class="key">4</span>
      <span class="key">5</span>
      <span class="key">6</span>
      <span class="key">*</span>
      <span class="key">1</span>
      <span class="key">2</span>
      <span class="key">3</span>
      <span class="key">-</span>
      <span class="key">=</span>
      <span class="key">0</span>
      <span class="key">.</span>
      <span class="key">+</span>

    </div>
  </div>

</body>

</html>

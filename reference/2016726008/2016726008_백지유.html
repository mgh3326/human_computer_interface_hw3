<!doctype html>
<html>
    <head>
        <title>calculator prototype</title>
        <style type = "text/css">
        body{
            margin: 0px 0px 0px 0px;
        }
        h1{
            font-family : "Avant Garde", Avantgarde, "Century Gothic", CenturyGothic,"AppleGothic",sans-serif;
            font-size : 30px;
            padding: 20px 10px;
            text-align: left;
            color:black;
        }
        #calculator{
            font-size: 0;
            width: 320px;
            background-color:dimgray;
            padding: 20px;
            margin: auto;
            border-radius:10px;
        }
        #result{
            width: 310px;
            height: 40px;
            margin-bottom: 15px;
            padding: 0px 5px 0px 5px;
            background-color:paleturquoise;
            border-radius:5px;
            display: inline-flex;
            justify-items:  flex-end;
            align-items: center;
            overflow: hidden;
            box-shadow: inset 0 0px 3px;
            font: 20px digital;
        }
        #notevalresult{
            width: 310px;
            height: 20px;
            margin-bottom: 5px;
            padding: 0px 5px 0px 5px;
            background-color:paleturquoise;
            border-radius:5px;
            display: inline-flex;
            justify-items:  flex-end;
            align-items: center;
            overflow: hidden;
            box-shadow: inset 0 0px 1px;
            font: 15px digital;
        }
        .key {
            width: 35px;
            height: 25px;
            background-color:white;
            display: inline-flex;
            margin: 3px 5px 8px 0px;
            vertical-align: middle;
            justify-content: center;
            align-items: center;
            padding: 5px 0px 5px 0px;
            border-radius: 3px;
            cursor: pointer;
            box-shadow: 0 3px 0 lightgray, 0 2px 5px rgba(0, 0, 0, .75);
            font: bold 20px sans-serif;
        }
        .number-key{
            background-color: yellow;
            color:black;
        }

        .symbol-key{
            font: italic 20px "Times New Roman"
        }

        .function-key{
            font: italic 15px "Times New Roman"
        }

        .ev-key{
            width:155px;
            background-color:blue;
            color: white;
        }
       
        .clear-key{
            width:90px;
            
            background-color: red;
            color: white;
        }
        .bs-key{
            width:60px;
            background-color:green;
            color:white;
        }
        .special-key{
            width:60px;
            font: italic 20px "Times New Roman";
            display: none;
        }
       
        .key:active{
            background-color: #a1a1a1;
            box-shadow: 0 5px #666;
            transform: translateY(4px);
        }

        
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" type="text/javascript"></script>
        <script src = "math.js" type = "text/javascript"></script>
        <script type = "text/javascript">
        $(document).ready(function(){
            var parser = math.parser();
            var dp = '0';
            var lastdp='0';
           // var mtdp='0';
            $('#notevalresult').text(dp);
            $('#result').text(dp);

            $('.key').each(function(index,key){
                $(this).click(function(e){
                    
                    if(dp=='0') dp='';
                    
                    if($(this).text()=='1'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='2'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='3'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='4'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='5'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='6'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='7'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='8'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='9'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else if($(this).text()=='0'){
                        $('.special-key').css({'display':'inline-block'});
                    }
                    else{
                        $('.special-key').css({'display':'none'});
                    }

                    if($(this).text() == 'EV')
                    {
                        try{
                            dp = parser.eval(dp).toString();
                            var token = dp.split(' ');
                            if(token[0]=='function'){
                                dp = token[0];
                            }
                            $('#result').text(dp);

                        }
                        catch(e){
                            dp = '0';
                            if(dp != 'function'){
                                $('#result').text(e);
                            }

                        }
                    }
                    else if($(this).text() == 'Clear'){
                        dp = '0';
                        $('#result').text(dp);
                        $('#notevalresult').text(dp);
                    }
                    else if($(this).text()=='←'){
                       // dp = $(this).text();
                       // var index='0';
                       // index=dp.indexOf("←");
                        //dp= dp.subString(0,index-1);
                        //dp = dp.substring(0,dp.length-1);
                        dp=lastdp;
                        $('#result').text(lastdp);
                        $('#notevalresult').text(lastdp);
                        
                    }
                    else{
                        lastdp = dp;
                        //mtdp = dp;
                        dp += $(this).text();
                        $('#result').text(dp);
                        $('#notevalresult').text(dp);
                    }

                    
                    
                    e.preventDefault()
                })
            })
        })
        </script>
    </head>
    <body>
        <h1>Calculator prototype</h1>
        <div id="calculator">
            <div id="notevalresult">0</div>
            <div id="result">0</div>
            <span class="key function-key">sin(</span>
            <span class="key function-key">cos(</span>
            <span class="key function-key">tan(</span>
            <span class="key function-key">exp</span>
            <span class="key function-key">log</span>
            <span class="key function-key">det</span>
            <span class="key function-key">sqrt</span>
            <span class="key function-key">cross</span>

            <span class="key"><</span>
            <span class="key">></span>
            <span class="key"><=</span>
            <span class="key">>=</span>
            <span class="key">==</span>
            <span class="key">!=</span>
            <span class="key">.</span>
            <span class="key symbol-key">pi</span>
            
            <span class="key">+</span>
            <span class="key">-</span>
            <span class="key">*</span>
            <span class="key">/</span>
            <span class="key">%</span>
            <span class="key">^</span>
            <span class="key">,</span>
            <span class="key">=</span>
            
            <span class="key number-key">7</span>
            <span class="key number-key">8</span>
            <span class="key number-key">9</span>
            <span class="key number-key">0</span>
            <span class="key">(</span>
            <span class="key">)</span>
            <span class="key">[</span>
            <span class="key">]</span>
            
            <span class="key number-key">4</span>
            <span class="key number-key">5</span>
            <span class="key number-key">6</span>
            <span class="key number-key">00</span>
            <span class="key symbol-key">i</span>
            <span class="key symbol-key">e</span>
            <span class="key symbol-key">f</span>
            <span class="key symbol-key">g</span>
            

            <span class="key number-key">1</span>
            <span class="key number-key">2</span>
            <span class="key number-key">3</span>
            <span class="key number-key">000</span>
            <span class="key symbol-key">f(x)</span>
            <span class="key symbol-key">x</span>
            <span class="key symbol-key">y</span>
            <span class="key symbol-key">z</span>

            <span class="key bs-key">←</span>
            <span class="key clear-key">Clear</span>
            <span class="key ev-key">EV</span>

            <span class="key special-key">+(</span>
            <span class="key special-key">-(</span>
            <span class="key special-key">*(</span>
            <span class="key special-key">/(</span>

        </div>

    </body>
</html>